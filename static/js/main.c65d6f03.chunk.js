(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),c=a(16),r=a.n(c),i=(a(15),a(5)),l=a(3),s=a(7),u=a(8),m=new(function(){function e(t){Object(s.a)(this,e),this._url=t.url,this._headers=t.headers}return Object(u.a)(e,[{key:"_getResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then(function(t){return e._getResponse(t)})}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then(function(t){return e._getResponse(t)})}},{key:"editUserInfo",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(function(e){return t._getResponse(e)})}},{key:"updateAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(function(e){return t._getResponse(e)})}},{key:"addCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(function(e){return t._getResponse(e)})}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(function(e){return t._getResponse(e)})}},{key:"toggleLikeCard",value:function(e,t){var a=this,n=t?"PUT":"DELETE";return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:n,headers:this._headers}).then(function(e){return a._getResponse(e)})}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-47",headers:{authorization:"3b67ac11-b29e-4182-9110-a6f8ab5d8b17","Content-Type":"application/json"}}),p=a(0),d=function(e){var t=e.isLoggedIn,a=e.children;return t?a:o.a.createElement(p.a,{to:"/signin"})},_=a(17),f=a.n(_),h=a(6);function b(e){var t=e.isLoggedIn,a=e.onSignOut,n=e.email,c=o.a.useState(!1),r=Object(l.a)(c,2),i=r[0],s=r[1],u=function(e){s(!i)};return o.a.createElement("header",{className:"".concat(t?"header header__mobile":"header")},o.a.createElement("img",{src:f.a,alt:"\u043b\u043e\u0433\u043e",className:"header__logo"}),o.a.createElement(p.d,null,o.a.createElement(p.b,{path:"/signin",element:o.a.createElement(h.b,{to:"/signup",className:"header__link"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")}),o.a.createElement(p.b,{path:"/signup",element:o.a.createElement(h.b,{to:"/signin",className:"header__link"},"\u0412\u043e\u0439\u0442\u0438")}),o.a.createElement(p.b,{exact:!0,path:"/",element:t?o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"header-burger",onClick:u},o.a.createElement("span",{className:"".concat(i?"header-burger__line header-burger__line_active":"header-burger__line")}),o.a.createElement("span",{className:"".concat(i?"header-burger__line header-burger__line_active":"header-burger__line")}),o.a.createElement("span",{className:"".concat(i?"header-burger__line header-burger__line_active":"header-burger__line")})),o.a.createElement("div",{className:"".concat(i?"header__menu":"header__menu header__menu_inactive")},o.a.createElement("p",{className:"header__email"},n," "),o.a.createElement(h.b,{to:"/signin",className:"header__link header__link_menu",onClick:function(){u(),a()}},"\u0412\u044b\u0439\u0442\u0438"))):null})))}var g=a(18),E=a.n(g),v=a(19),N=a.n(v),C=o.a.createContext();function k(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,c=e.onCardDelete,r=o.a.useContext(C),i=t.owner._id===r._id,l=t.likes.some(function(e){return e._id===r._id});return o.a.createElement("div",{className:"photo-card"},i&&o.a.createElement("button",{type:"button",className:"photo-card__btn-delete",title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){return c(t)}},o.a.createElement("div",{className:"photo-card__trash"},o.a.createElement("img",{src:E.a,alt:"\u043a\u043e\u0440\u0437\u0438\u043d\u0430-\u0432\u0435\u0440\u0445",className:"photo-card__delete-top"}),o.a.createElement("img",{src:N.a,alt:"'\u043a\u043e\u0440\u0437\u0438\u043d\u0430-\u043d\u0438\u0437",className:"photo-card__delete"}))),o.a.createElement("img",{src:t.link,alt:t.name,className:"photo-card__image",onClick:function(){return a(t)}}),o.a.createElement("div",{className:"photo-card__caption"},o.a.createElement("h2",{className:"photo-card__text"},t.name),o.a.createElement("div",{className:"photo-card__container-like"},o.a.createElement("button",{type:"button",className:"photo-card__like ".concat(l?"photo-card__like_active":""),title:"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){return n(t)}}),o.a.createElement("p",{className:"photo-card__like-count"},t.likes.length))))}function O(e){var t=e.cards,a=e.onEditAvatar,n=e.onEditProfile,c=e.onAddPlace,r=e.onCardClick,i=e.onCardLike,l=e.onCardDelete,s=o.a.useContext(C);return o.a.createElement("main",null,o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__info"},o.a.createElement("img",{src:s.avatar,alt:s.name,className:"profile__image"}),o.a.createElement("button",{type:"button",onClick:a,className:"profile__edit-avatar-button"}),o.a.createElement("div",{className:"profile__text-block"},o.a.createElement("div",{className:"profile__text-container"},o.a.createElement("h1",{className:"profile__name"},s.name),o.a.createElement("button",{type:"button",onClick:n,className:"profile__edit-button",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})),o.a.createElement("p",{className:"profile__job"},s.about))),o.a.createElement("button",{type:"button",onClick:c,className:"profile__add-button",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e"})),o.a.createElement("section",{className:"photos","aria-label":"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u043c\u0435\u0441\u0442"},o.a.createElement("ul",{className:"photos__list"},t.map(function(e){return o.a.createElement("li",{key:e._id},o.a.createElement(k,{card:e,onCardClick:r,onCardLike:i,onCardDelete:l}))}))))}var j=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__text"},"\xa9 2022 Mesto Russia"))},y=a(4),S=a(12);function w(e){var t=Object(n.useState)(e),a=Object(l.a)(t,2),o=a[0],c=a[1];return{values:o,setValues:c,handleChange:function(e){var t=e.target,a=t.name,n=t.value;c(function(e){return Object(S.a)({},e,Object(y.a)({},a,n))})}}}function I(e){var t=w({emailInput:"",passwordInput:""}),a=t.values,n=t.setValues,c=t.handleChange;return o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit({email:a.emailInput,password:a.passwordInput}),n(a)},name:e.name,className:"enter",noValidate:!0},o.a.createElement("h2",{className:"enter__title"},e.title),o.a.createElement("input",{value:a.emailInput,onChange:c,name:"emailInput",type:"email",className:"enter__input",placeholder:"email@mail.com",required:!0}),o.a.createElement("input",{value:a.passwordInput,onChange:c,name:"passwordInput",type:"password",className:"enter__input",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0}),o.a.createElement("button",{type:"submit",className:"enter__submit-btn"},e.buttonTitle),o.a.createElement("p",{className:"enter__text"},e.regText,o.a.createElement(h.b,{to:"/signin",className:"enter__link"},e.regLink)))}function T(e){return o.a.createElement("div",{className:"page"},o.a.createElement(I,{name:"login",onSubmit:e.onLogin,title:"\u0412\u0445\u043e\u0434",buttonTitle:"\u0412\u043e\u0439\u0442\u0438"}))}function x(e){return o.a.createElement("div",{className:"register"},o.a.createElement(I,{name:"register",onSubmit:e.onRegister,title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonTitle:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",regText:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",regLink:"\u0412\u043e\u0439\u0442\u0438"}))}function L(e){return e.isOpen?o.a.createElement("div",{className:"popup ".concat(e.name,"-popup ").concat(e.isOpen&&"popup_opened"),onClick:e.onClose},o.a.createElement("form",{name:"".concat(e.name),className:"popup__container",onSubmit:e.onSubmit,onClick:function(e){e.stopPropagation()}},o.a.createElement("button",{type:"button",className:"popup__btn-close",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose}),o.a.createElement("h4",{className:"popup__title"},"".concat(e.title)),e.children,o.a.createElement("button",{type:"submit",className:"popup__btn-submit",title:"".concat(e.buttonTitle)},"".concat(e.buttonTitle)))):null}function P(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,c=w({userName:"",userJob:""}),r=c.values,i=c.setValues,l=c.handleChange,s=o.a.useContext(C);return o.a.useEffect(function(){s&&t&&i({userName:s.name,userJob:s.about})},[s,t]),o.a.createElement(L,{name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:r.userName,about:r.userJob})}},o.a.createElement("input",{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",className:"popup__field popup__field_top",name:"userName",id:"name-input",value:r.userName,onChange:l}),o.a.createElement("input",{type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__field",name:"userJob",id:"job-input",value:r.userJob,onChange:l}))}function A(e){var t=w({caption:"",link:""}),a=t.values,n=t.setValues,c=t.handleChange;o.a.useEffect(function(){e.isOpen&&n({name:"",link:""})},[e.isOpen]);return o.a.createElement(L,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTitle:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddNewPlace({name:a.caption,link:a.link})}},o.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__field popup__field_top",name:"caption",id:"text-input",value:a.caption||"",onChange:c}),o.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__field",name:"link",id:"url-input",value:a.link||"",onChange:c}))}function R(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,c=o.a.useRef();return o.a.createElement(L,{isOpen:t,onClose:a,name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(e){e.preventDefault(),n({avatar:c.current.value})}},o.a.createElement("input",{ref:c,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__field popup__field_top",name:"avatar",id:"avatar-url-input"}))}function D(e){var t=e.card,a=e.onClose;return t?o.a.createElement("div",{className:"popup photo-popup ".concat(t.name&&"popup_opened"),onClick:a},o.a.createElement("figure",{className:"photo-popup__container",onClick:function(e){e.stopPropagation()}},o.a.createElement("img",{src:t.link,alt:t.name,className:"photo-popup__image"}),o.a.createElement("figcaption",{className:"photo-popup__caption"},t.name),o.a.createElement("button",{type:"button",className:"popup__btn-close",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:a}))):null}var J=a(20),U=a.n(J),F=a(21),V=a.n(F);function B(e){var t=e.isOpen,a=e.onClose,n=e.isSuccess;return t?o.a.createElement("div",{className:"popup info-popup ".concat(t&&"popup_opened"),onClick:a},o.a.createElement("figure",{className:"popup__container",onClick:function(e){e.stopPropagation()}},o.a.createElement("button",{type:"button",className:"popup__btn-close",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:a}),n?o.a.createElement("div",null,o.a.createElement("img",{src:U.a,alt:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f: \u0443\u0441\u043f\u0435\u0445",className:"popup__image"}),o.a.createElement("figcaption",{className:"popup__title popup__title_info"},"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c")):o.a.createElement("div",null,o.a.createElement("img",{src:V.a,alt:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f: \u043e\u0448\u0438\u0431\u043a\u0430",className:"popup__image"}),o.a.createElement("figcaption",{className:"popup__title popup__title_info"},"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")))):null}var q=function(e){var t=e.url,a=e.method,n=void 0===a?"POST":a,o=e.token,c=e.data;return fetch("".concat("https://auth.nomoreparties.co").concat(t),Object(S.a)({method:n,headers:Object(S.a)({"Content-Type":"application/json"},!!o&&{Authorization:"Bearer ".concat(o)})},!!c&&{body:JSON.stringify(c)})).then(function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status)))})};var z=function(){var e=Object(n.useState)({name:"One moment...",about:"",avatar:""}),t=Object(l.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)([]),s=Object(l.a)(r,2),u=s[0],_=s[1],f=Object(n.useState)(!1),h=Object(l.a)(f,2),g=h[0],E=h[1],v=Object(n.useState)(!1),N=Object(l.a)(v,2),k=N[0],y=N[1],S=Object(n.useState)(!1),w=Object(l.a)(S,2),I=w[0],L=w[1],J=Object(n.useState)({name:"",link:"",alt:""}),U=Object(l.a)(J,2),F=U[0],V=U[1],z=Object(n.useState)(!1),H=Object(l.a)(z,2),M=H[0],G=H[1],K=Object(n.useState)(!1),Q=Object(l.a)(K,2),W=Q[0],X=Q[1],Y=Object(n.useState)(""),Z=Object(l.a)(Y,2),$=Z[0],ee=Z[1],te=Object(n.useState)(!1),ae=Object(l.a)(te,2),ne=ae[0],oe=ae[1],ce=Object(n.useState)(!1),re=Object(l.a)(ce,2),ie=re[0],le=re[1],se=Object(p.m)();o.a.useEffect(function(){!function(){if(localStorage.getItem("jwt")){var e,t=localStorage.getItem("jwt");(e=t,q({url:"/users/me",method:"GET",token:e})).then(function(e){e&&(ee(e.data.email),X(!0),se("/"))})}}()},[se]),o.a.useEffect(function(){localStorage.getItem("jwt")&&$&&Promise.all([m.getUserInfo(),m.getInitialCards()]).then(function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];c(a),_(n)}).catch(function(e){console.log(e),se("/signin")}).finally(function(){setTimeout(ue,2e3)})},[W]);var ue=function(){oe(!0)};function me(e){"Escape"===e.key&&pe()}function pe(){L(!1),E(!1),y(!1),G(!1),V({name:"",link:""}),document.removeEventListener("keydown",me)}return o.a.useEffect(function(){(I||g||k||F||M)&&document.addEventListener("keydown",me)}),o.a.createElement(C.Provider,{value:a},o.a.createElement(b,{onSignOut:function(){localStorage.removeItem("jwt"),X(!1),se("/signin"),ee("")},isLoggedIn:W,email:$}),o.a.createElement(p.d,null,o.a.createElement(p.b,{path:"/signin",element:W?o.a.createElement(p.a,{to:"/"}):o.a.createElement(T,{onLogin:function(e){return function(e){var t=e.email,a=e.password;return q({url:"/signin",data:{email:t,password:a}})}(e).then(function(e){e.token&&(localStorage.setItem("jwt",e.token),X(!0))}).catch(function(e){console.log(e),X(!1),le(!1),G(!0)})}})}),o.a.createElement(p.b,{path:"/signup",element:W?o.a.createElement(p.a,{to:"/"}):o.a.createElement(x,{onRegister:function(e){(function(e){var t=e.email,a=e.password;return q({url:"/signup",data:{email:t,password:a}})})(e).then(function(e){e&&(le(!0),G(!0),setTimeout(se("/signin"),2e3))}).catch(function(e){console.log(e),le(!1),G(!0)})}})}),o.a.createElement(p.b,{exact:!0,path:"/",element:o.a.createElement(d,{path:"/",isLoggedIn:W},o.a.createElement(O,{cards:u,onEditProfile:function(e){E(!0)},onAddPlace:function(e){y(!0)},onEditAvatar:function(e){L(!0)},onCardClick:function(e){V(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e._id===a._id});m.toggleLikeCard(e._id,!t).then(function(t){_(function(a){return a.map(function(a){return a._id===e._id?t:a})})}).catch(function(e){return console.log(e)})},onCardDelete:function(e){m.deleteCard(e._id).then(function(){_(function(t){return t.filter(function(t){return t._id!==e._id})})}).catch(function(e){return console.log(e)})},isLoaded:ne}))})),o.a.createElement(P,{isOpen:g,onClose:pe,onUpdateUser:function(e){m.editUserInfo(e).then(function(e){c(e),pe()}).catch(function(e){return console.log(e)})}}),o.a.createElement(R,{isOpen:I,onClose:pe,onUpdateAvatar:function(e){m.updateAvatar(e).then(function(e){c(e),pe()}).catch(function(e){return console.log(e)})}}),o.a.createElement(A,{isOpen:k,onClose:pe,onAddNewPlace:function(e){m.addCard(e).then(function(e){_([e].concat(Object(i.a)(u))),pe()}).catch(function(e){return console.log(e)})}}),o.a.createElement(D,{card:F,onClose:pe}),o.a.createElement(B,{isOpen:M,onClose:pe,isSuccess:ie}),o.a.createElement(j,null))},H=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,101)).then(function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),o(e),c(e),r(e)})};r.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(h.a,null,o.a.createElement(z,null)))),H()},15:function(e,t,a){},17:function(e,t,a){e.exports=a.p+"static/media/logo.51772f7c.svg"},18:function(e,t,a){e.exports=a.p+"static/media/trash-top.8ceae468.svg"},19:function(e,t,a){e.exports=a.p+"static/media/trash-bottom.ba2b26b8.svg"},20:function(e,t,a){e.exports=a.p+"static/media/yes.7fc4c149.svg"},21:function(e,t,a){e.exports=a.p+"static/media/fail.c32299fa.svg"},22:function(e,t,a){e.exports=a(100)}},[[22,3,2]]]);
//# sourceMappingURL=main.c65d6f03.chunk.js.map